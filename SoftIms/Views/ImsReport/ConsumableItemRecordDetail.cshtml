@model SoftIms.Data.ViewModel.ItemRecordViewModel
@{
    ViewBag.Title = "Consumable Item RecordDetail";
    int sno = 0;
    var tdStyle = "border:1px solid; vertical-align:middle;";
}


<div class="col-xs-12">
    <div class="box box-info">
        <div class="box-body" style="min-height:400px;">
            <div id="printablediv">
                <div class="row">
                    <div class="col-xs-3"></div>
                    <div class="text-center col-xs-6">
                        <h3>नेपाल दूरसञ्चार प्राधिकरण </h3>
                        <h4>काठमाडौं</h4>
                        <h3>खर्च भएर जाने जिन्सी मालसामानको खाता</h3>
                    </div>
                    <div class="col-xs-3">
                        <span class="pull-right" font-size:small">म.ले.प.फा.नं.५२</span>
                    </div>
                    <br />
                </div>
                <div class="row">
                    <div class="col-xs-5">
                        <div>जिन्सी सामानको नाम : @Model.ItemName</div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-5">
                        <div>इकाई : @Model.ItemUnitName</div>
                    </div>
                    <div class="col-xs-7">
                        <div>सम्पत्ति वर्गीकरण संकेत नम्बर : @Model.ItemCode</div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-5">
                        <div>स्पेसिफिकेशन : @Model.Specification</div>
                    </div>
                </div>
                <div class="row" style="margin-top:10px;">
                    <div class="col-xs-12">
                        <div class="form-group">
                            <table id="tblConsumableItemDetail" border="1" style="border-collapse:collapse; width:100%;" class="table">
                                <thead class="bg-gray-light">
                                    <tr>
                                        <td width="10%" rowspan="2" class="text-center" style="@tdStyle;">मिती</td>
                                        <td width="10%" rowspan="2" class="text-center" style="@tdStyle;">दाखिला नं./निकासी नं.</td>
                                        <td colspan="3" width="20%" class="text-center" style="@tdStyle;">आम्दानी</td>
                                        <td colspan="3" width="20%" class="text-center" style="@tdStyle;">खर्च</td>
                                        <td colspan="3" width="20%" class="text-center" style="@tdStyle;">बाकी</td>
                                        <td rowspan="2" class="text-center" width="20%" style="@tdStyle;">कैफियत</td>@*No remarks field in datatable*@
                                    </tr>
                                    <tr>
                                        <td class="text-center" style="@tdStyle;">परिमाण</td>
                                        <td class="text-center" style="@tdStyle;">दर</td>
                                        <td class="text-center" style="@tdStyle;">रकम")</td>
                                        <td class="text-center" style="@tdStyle;">परिमाण</td>
                                        <td class="text-center" style="@tdStyle;">दर</td>
                                        <td class="text-center" style="@tdStyle;">रकम</td>
                                        <td class="text-center" style="@tdStyle;">परिमाण</td>
                                        <td class="text-center" style="@tdStyle;">दर</td>
                                        <td class="text-center" style="@tdStyle;">रकम</td>
                                    </tr>
                                    <tr>
                                        <td class="text-center" style="@tdStyle;">१</td>
                                        <td class="text-center" style="@tdStyle;">२</td>
                                        <td class="text-center" style="@tdStyle;">३</td>
                                        <td class="text-center" style="@tdStyle;">४</td>
                                        <td class="text-center" style="@tdStyle;">५</td>
                                        <td class="text-center" style="@tdStyle;">६</td>
                                        <td class="text-center" style="@tdStyle;">७</td>
                                        <td class="text-center" style="@tdStyle;">८</td>
                                        <td class="text-center" style="@tdStyle;">९</td>
                                        <td class="text-center" style="@tdStyle;">१०</td>
                                        <td class="text-center" style="@tdStyle;">११</td>
                                        <td class="text-center" style="@tdStyle;">१२</td>
                                    </tr>

                                </thead>
                                <tbody class="tbl-item-list">
                                    @foreach (var item in Model.Detail)
                                    {
                                        sno++;
                                        <tr>
                                            <td class="text-center" style="@tdStyle;">@DateMiti.GetDateMiti.GetMiti(item.Date)</td>
                                            <td class="text-center" style="@tdStyle;">@item.DisplayDocumentNo</td>
                                            <td class="text-center" style="@tdStyle;">@((item.EarningsQuantity == 0) ? "" : item.EarningsQuantity.ToString())</td>
                                            <td class="text-center" style="@tdStyle;">@((item.EarningsUnitPrice == 0) ? "" : item.EarningsUnitPrice.ToString("N2", System.Globalization.CultureInfo.InvariantCulture))</td>
                                            <td class="text-center" style="@tdStyle;">@((item.EarningsTotalPrice == 0) ? "" : item.EarningsTotalPrice.ToString("N2", System.Globalization.CultureInfo.InvariantCulture))</td>
                                            <td class="text-center" style="@tdStyle;">@((item.ExpenseQuantity == 0) ? "" : item.ExpenseQuantity.ToString())</td>
                                            <td class="text-center" style="@tdStyle;">@((item.ExpensesUnitPrice == 0) ? "" : item.ExpensesUnitPrice.ToString("N2", System.Globalization.CultureInfo.InvariantCulture))</td>
                                            <td class="text-center" style="@tdStyle;">@((item.ExpensesTotalPrice == 0) ? "" : item.ExpensesTotalPrice.ToString("N2", System.Globalization.CultureInfo.InvariantCulture))</td>
                                            <td class="text-center" style="@tdStyle;">@((item.RemainingQuantity == 0) ? "" : item.RemainingQuantity.ToString())</td>
                                            <td class="text-center" style="@tdStyle;">@((item.RemainingUnitPrice == 0) ? "" : item.RemainingUnitPrice.ToString("N2", System.Globalization.CultureInfo.InvariantCulture))</td>
                                            <td class="text-center" style="@tdStyle;">@((item.RemainingTotalPrice == 0) ? "" : item.RemainingTotalPrice.ToString("N2", System.Globalization.CultureInfo.InvariantCulture))</td>
                                            <td class="text-center" style="@tdStyle;"></td>
                                        </tr>
                                    }
                                    @if (sno == 0)
                                    {
                                        <tr>
                                            <td colspan="12" style="@tdStyle;" class="text-center">रेकर्ड भेटिएन् ।</td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-4">
                        <p> फाँटवालाको दस्तखत : </p>
                        <p> मिती : </p>
                    </div>
                    <div class="col-xs-4">
                        <p> शाखा प्रमुखको दस्तखत : </p>
                        <p> मिती : </p>
                    </div>
                    <div class="col-xs-4">
                        <p> कार्यलय प्रमुखको दस्तखत : </p>
                        <p> मिती : </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<hr />
<div class="row">
    <div class="col-xs-12 pull-right" style="padding-left: 30px;">
        <button type="button" class="btn btn-info btnPrint" data-static-title="true" data-print-element="#printablediv"><span class="fa fa-print"></span></button>
        <button type="button" class="toexcel btn btn-success" data-report-title="Consumable Item Detail" data-sheet="Sheet1" data-table="#tblConsumableItemDetail"><img src="~/Content/img/excel-export-16x16.png" /></button>
    </div>
</div>



